{% import '_bin/_form.html' as frm %}
{% import 'bin/default.html' as def %}

<fieldset id="{{ view.id }}-edit" class="view-insert hidden">
	<div class="form-row">
		<div class="col-6 col-md">
			<span class="label-top">giorno</span>
			{{ frm.select( table, '', '', '__giorno_u__', '', etc.select.giorni_settimana, '', '', '', '', '', '', 2) }}
		</div>
		<div class="col-6 col-md-auto">
			<span class="label-top">dal</span>
			{{ frm.date( table, '', '', '__data_inizio_u__', '', '', '', '', '', '', '', 2 ) }}
		</div>
		<div class="col-6 col-md-auto">
			<span class="label-top">al</span>
			{{ frm.date( table, '', '', '__data_fine_u__', '', '', '', '', '', '', '', 2 ) }}
		</div>
		<div class="col-2 col-md-1">
			<span class="label-top">ora inizio</span>
			{{ frm.time( table, '', '', '__ora_inizio_u__', '', '', '', '', '', '', '', 2) }} 
		</div>
		<div class="col-2 col-md-1">
			<span class="label-top">ora fine</span>
			{{ frm.time( table, '', '', '__ora_fine_u__', '', '', '', '', '', '', '', 2) }} 
		</div>
	</div>
	<div class="form-row">
		<div class="col-6 col-md">
			<span class="label-top">modifica luogo</span>
			{{ frm.selectBox( table, '', '', '__id_luogo_u__', '', etc.select.luoghi, request, '', '', '', '', 'font-awesome', '', '', '', '', '', '', '', '', '2' ) }}
		</div>
	</div>
	<div class="form-row">
		<div class="col-12 col-md-6">
			<span class="label-top">aggiungi istruttore</span>
			{{ frm.selectBox( table, '', '', '__id_anagrafica_plus__', '', etc.select.anagrafica, request, '', '', '', '', 'font-awesome', '', '', '', '', page, pages, lang, '', '2' ) }}
		</div>
		<div class="col-12 col-md-6">
			<span class="label-top">rimuovi istruttore</span>
			{{ frm.selectBox( table, '', '', '__id_anagrafica_remove__', '', etc.select.anagrafica, request, '', '', '', '', 'font-awesome', '', '', '', '', page, pages, lang, '', '2' ) }}
		</div>
	</div>
	<div class="form-row">
		<div class="col-6 col-md-6">
			<span class="label-top">sostituisci istruttore</span>
			{{ frm.selectBox( table, '', '', '__id_anagrafica_remove_sostituzione__', '', etc.select.anagrafica, request, '', '', '', '', 'font-awesome', '', '', '', '', page, pages, lang, '', '2' ) }}
		</div>
		<div class="col-6 col-md">
			<span class="label-top">con</span>
			{{ frm.selectBox( table, '', '', '__id_anagrafica_sostituzione__', '', etc.select.anagrafica, request, '', '', '', '', 'font-awesome', '', '', '', '', page, pages, lang, '', '2') }}
		</div>
		<div class="col-12 col-md-auto">
			{{ frm.button(  'MODIFICA' ,'button','btn btn-secondary btn-sm btn-block', 'modificaTodo($(\'#progetti___giorno_u__\').val(),$(\'#progetti___data_inizio_u__\').val(),$(\'#progetti___data_fine_u__\').val(),$(\'#progetti___ora_inizio_u__\').val(),$(\'#progetti___ora_fine_u__\').val(),$(\'#progetti___id_luogo_u__\').val(),$(\'#progetti___id_anagrafica_plus__\').val(),$(\'#progetti___id_anagrafica_remove__\').val(),$(\'#progetti___id_anagrafica_remove_sostituzione__\').val(),$(\'#progetti___id_anagrafica_sostituzione__\').val());','modifica massivamente le lezioni', 'btnedit' ) }}
		</div>
	</div>
</fieldset>
<script>
	function modificaTodo( giorno, data_inizio, data_fine, ora_inizio, ora_fine, luogo, addi, removei, deletei, newi ) {
			
			$('#btnedit').html('<i class="fa fa-circle-o-notch fa-spin fa-fw"></i> MODIFICA IN CORSO');

			var call = '{{ site.url }}_mod/_1200.todo/_src/_api/_task/_todo.update.php';
			var par = '&__g__=' + giorno + '&__d_i__=' + data_inizio + '&__d_f__=' + data_fine + '&__o_i__=' + ora_inizio + '&__o_f__=' + ora_fine + '&__l__=' + luogo + '&__addi__=' + addi + '&__removei__=' + removei + '&__deletei__=' + deletei + '&__newi__=' + newi ;
			console.log(par);
			getws(
				call + '?progetto={{ request[form.table].id }}'+ par,
				null,
				function( data ) {
					console.log( data );
				//	$( '#'+id ).val( data.new );
				//	$( '#'+id ).val( data.new );
				if( data.err ) { 
						alert( data.err ); 
					} else if( data.__status__ == 'OK' )  {
						location.reload();
					}
					$('#btnedit').html('MODIFICA');

				}
			);

			}
</script>
