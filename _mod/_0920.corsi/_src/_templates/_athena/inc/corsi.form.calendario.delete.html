{% import '_bin/_form.html' as frm %}
{% import 'bin/default.html' as def %}

<fieldset id="{{ view.id }}-delete" class="view-insert hidden">
	<div class="form-row">
		<div class="col-6 col-md-auto">
			<span class="label-top">giorno</span>
			{{ frm.select( table, '', '', '__giorno_d__', '', etc.select.giorni_settimana, '', '', '', '', '', '', 2) }}
		</div>
		<div class="col-6 col-md-auto">
			<span class="label-top">dal</span>
			{{ frm.date( table, '', '', '__data_inizio_d__', '', '', '', '', '', '', '', 2 ) }}
		</div>
		<div class="col-6 col-md-auto">
			<span class="label-top">al</span>
			{{ frm.date( table, '', '', '__data_fine_d__', '', '', '', '', '', '', '', 2 ) }}
		</div>
		<div class="col-2 col-md-1">
			<span class="label-top">ora inizio</span>
			{{ frm.time( table, '', '', '__ora_inizio_d__', '', '', '', '', '', '', '', 2) }} 
		</div>
		<div class="col-2 col-md-1">
			<span class="label-top">ora fine</span>
			{{ frm.time( table, '', '', '__ora_fine_d__', '', '', '', '', '', '', '', 2) }} 
		</div>
		<div class="col-6 col-md">
			<span class="label-top">luogo</span>
			{{ frm.selectBox( table, '', '', '__id_luogo_d__', '', etc.select.luoghi, request, '', '', '', '', 'font-awesome', '', '', '', '', '', '', '', '', '2') }}
		</div>
		<div class="col-12 col-md-auto">
			{{ frm.button(  'ELIMINA' ,'button','btn btn-secondary btn-sm btn-block', 'eliminaTodo($(\'#progetti___giorno_d__\').val(),$(\'#progetti___data_inizio_d__\').val(),$(\'#progetti___data_fine_d__\').val(),$(\'#progetti___ora_inizio_d__\').val(),$(\'#progetti___ora_fine_d__\').val(),$(\'#progetti___id_luogo_d__\').val());','elimina lezioni', 'btnelimina' ) }}
		</div>
	</div>
</fieldset>
<script>
	function eliminaTodo( giorno, data_inizio, data_fine, ora_inizio, ora_fine, luogo ) {
			
			$('#btnelimina').html('<i class="fa fa-circle-o-notch fa-spin fa-fw"></i> ELIMINAZIONE IN CORSO');

			var call = '{{ site.url }}_mod/_1200.todo/_src/_api/_task/_todo.delete.massiva.php';
			var par = '&__g__=' + giorno + '&__d_i__=' + data_inizio + '&__d_f__=' + data_fine + '&__o_i__=' + ora_inizio + '&__o_f__=' + ora_fine + '&__l__=' + luogo;
			console.log(par);
			getws(
				call + '?progetto={{ request[form.table].id }}'+ par,
				null,
				function( data ) {
					console.log( data );
				//	$( '#'+id ).val( data.new );
				if( data.err ) { 
						alert( data.err ); 
					} else if( data.__status__ == 'OK' )  {
						location.reload();
					}
					$('#btnelimina').html('ELIMINA');
				}
			);

			}
</script>
