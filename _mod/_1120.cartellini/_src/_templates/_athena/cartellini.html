{% import '_bin/_form.html' as frm %}
{% import 'bin/default.html' as def %}

{% extends "ext/main.html" %}

{% block main %}

{# FORM DI GESTIONE #}
<section class="row flex-fill">
    <div class="col-md-12 d-flex flex-column">

    <form id="form-filtro" class="form-main form-horizontal d-flex flex-column flex-fill" action="{{ page.path[ localization.language.ietf ] }}" method="post">
        <div class="form-row view-filters d-print-none cks">
            <div class="col-12 col-md-auto">
            <span class="label-top">mese</span>
            <select name="__view__[{{ view.id }}][__filters__][mese][EQ]" onchange="$('#pager').val('0');" class="form-control form-control-sm">
            {% for id, nome in etc.select.mesi %}
                <option value="{{ id }}" {% if request.__view__[ view.id ].__filters__.mese.EQ == id %}selected{% endif %}>{{ nome }}</option>
            {% endfor %}
            </select>
            </div>

            <div class="col-12 col-md-auto">
                <span class="label-top">anno</span>
                <select name="__view__[{{ view.id }}][__filters__][anno][EQ]" onchange="$('#pager').val('0');" class="form-control form-control-sm">
                {% for id, nome in etc.select.anni %}
                    <option value="{{ id }}" {% if request.__view__[ view.id ].__filters__.anno.EQ == id %}selected{% endif %}>{{ nome }}</option>
                {% endfor %}
                </select>
            </div>

            <div class="col-12 col-md">
                <span class="label-top">operatore</span>
                <div class="row m-0">
                    <div class="col combobox-container p-0">
                        <select name="__view__[{{ view.id }}][__filters__][id_anagrafica][EQ]" populate-api onchange="$('#pager').val('0');" class="selectbox form-control form-control-sm" id="operatore">
                            <option value="" {% if request.__view__[ view.id ].__filters__.id_anagrafica.EQ == "" %}selected{% endif %}></option>
                        {% for operatore  in etc.select.operatori %}
                            <option value="{{ operatore.id }}" {% if request.__view__[ view.id ].__filters__.id_anagrafica.EQ == operatore.id %}selected{% endif %}>{{ operatore.__label__ }}</option>
                        {% endfor %}
                        </select>
                    </div>
                    <div class="col-auto p-0 pl-1">
                        <button type="button" class="btn btn-sm btn-secondary btn-sqr" onclick="$('#operatore_inputbox').trigger('all');"><i class="fa fa-chevron-down"></i></button>
                    </div>
                </div>
            </div>

            <div class="col-auto">
                <button type="button" style="height: 31px" class="form-control form-control-sm btn btn-sm btn-secondary" onclick="submit();">APRI CARTELLINO</button>
            </div>
        </div>

        {% if request.__view__[ view.id ].__filters__.id_anagrafica.EQ %}
        
    
        {# BOTTONI E COMANDI DEL MODULO #}
	    <fieldset class="form-controls mt-auto">
            <div class="row no-gutters d-print-none">
                <div class="col-auto col-md-5">
	                <button type="button" class="btn btn-sm btn-secondary" onclick="window.open('{{ pages['attivita.view'].path[ localization.language.ietf ] }}','_self');" placeholder="torna indietro senza salvare le modifiche" data-toggle="tooltip" data-placement="bottom" data-delay="1000" title="" data-original-title="torna indietro senza salvare le modifiche"><i class="fa fa-undo"></i></button>
                </div>
                <div class="col col-md-2 text-center"></div>
                <div class="col-auto col-md-5 text-right">
                    <div class="row">
                        <div class="col">
                            <button type="submit" style="width: auto; padding-left: 10px; padding-right: 10px" class="btn btn-sm btn-secondary" onclick="submitFormOkay = true;" placeholder="salva e rimani nella pagina attuale" data-toggle="tooltip" data-placement="bottom" data-delay="1000" title="" data-original-title="salva e rimani nella pagina attuale">SALVA CARTELLINO</button>
                        </div>
                    </div>
                </div>
            </div>
        </fieldset>
        {% endif %}
    
    </form>
    </div>
</section>

{% endblock %}

{% block javascript %}
<script defer type="text/javascript">

    window.addEventListener( 'DOMContentLoaded', function() {
     $('.warning-if-changed-cst').on( 'keyup change', function() { 
         $('.cks select').prop('disabled', true);
         $('.cks input').prop('disabled', true);
         $('.cks button').prop('disabled', true);
        } );
    });

</script>
{% endblock %}
