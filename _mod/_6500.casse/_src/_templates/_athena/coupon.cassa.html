{% import '_bin/_default.html' as cms %}
{% import '_bin/_form.html' as frm %}
{% import 'bin/default.html' as def %}
{% import 'bin/ritiro.hardware.sub.html' as sub %}

{% extends 'ext/blank.html' %}

{# DEFINIZIONI #}

{% set ietf = localization.language.ietf %}

{# ACCOUNT #}
{% if session.account.id %}
    {% set account = session.account.id %}
{% else %}
    {% set account = '__null__' %}
{% endif %}

{% block header %}
<div class="text-left">
        {% set target = pages.casse.url[ localization.language.ietf ] %}
        <button type="button" class="btn btn-secondary btn-sqr btn-sm" onclick="window.open( '{{ target }}', '_self' );" data-toggle="tooltip" data-placement="bottom" data-delay="1000" title="torna alla dashboard"><i class="fa fa-arrow-circle-o-left" aria-hidden="true"></i></button>
</div>
{% endblock %}
{% block line %}
{% if session.contatto  %}
<div class="row d-flex align-items-center" style="color: white; background-color: #343A40; padding: 5px;padding-right: 30px;padding-left: 15px;">
    <div class="col"><h3>{{ session.contatto.nome }}</h3></div>
    <div class="text-right" >
        <button class="btn btn-light" onclick='window.open("{{ pages[ 'contatti.form' ].url[ localization.language.ietf ] }}?contatti[id]={{session.contatto.id }}&__backurl__={{page.backurl[ietf]}}", "_self")'>modifica</button> 
        <button class="btn btn-light" onclick='window.open("{{ pages.contatti.url[ localization.language.ietf ] }}?__unset__", "_self")'>inserisci nuovo</button> 
    </div>
</div>
{% endif %}
{% endblock %}
{% block main %}
<form  {% if session.contatto %}style="margin-top: 45px;"{% endif %} id="form-filtro" class="form-main form-horizontal d-flex flex-column flex-fill" action="{{ page.path[ localization.language.ietf ] }}" method="post">

<section>

    <legend>genera coupon</legend>
    {% set table = 'coupon' %}
    <div class="form-group form-row">
        <div class="col-12 col-md-2">
            <span class="label-top">coupon</span>
            {{ frm.inputRequired( table, '', '', 'id', '', '', request, 'CPON.'~now|date('U') ) }}
        </div>
        <div class="col-12 col-md">
            <span class="label-top">nome</span>
            {{ frm.inputRequired( table, '', '', 'nome', '', '', request, 'coupon generato in cassa il '~now|date('d/m/Y') ~ ' alle ' ~now|date('H:i') ) }}
        </div>
            {{ frm.input( table, '', '', 'timestamp_inizio', '', '', request, 'now'|date('U'), '', '', 'hidden' ) }}
    </div>	
        
    

    <div class="form-group form-row">

        <div class="col-12 col-md-2">
            <span class="label-top">sconto %</span>
            {{ frm.input( table, '', '', 'sconto_percentuale', '', '', request ) }}
        </div>
        
        <div class="col-12 col-md-2">
            <span class="label-top">sconto &euro;</span>
            {{ frm.input( table, '', '', 'sconto_fisso', '', '', request ) }}
        </div>
        

        <div class="col-auto col-form-label">
            
            <div class="form-check">
                {{ frm.checkbox( table, '', '', 'se_globale', 'globale', '', request, 1 ) }}
            </div>
        </div>

    </div>



<div class="form-group form-row">
 <div class="col-12 col-md">
            <span class="label-top">note</span>
            {{ frm.textarea( table, '', '', 'note','', 2, request ) }}
        </div>
    </div>
</fieldset>
<button class="btn btn-lg btn-secondary">salva</button>
{% if request[table].id %}
<button type="button" class="btn btn-lg btn-secondary" onclick="window.open('{{ site.url }}_mod/_4100.prodotti/_src/_api/_print/_stampa.coupon.pdf.php?id={{ request[table].id }}', '_blank')">stampa</button>
{% endif %}
<!--
<legend>reso</legend>
{# SUBFORM GRUPPI #}
{{ sub.righe( 'documenti', 'documenti_articoli', 'articoli reso', site, page, pages, ietf, etc, request, session, '', etc.mastro ) }}
-->
</form>

  

</section>
{% endblock %}